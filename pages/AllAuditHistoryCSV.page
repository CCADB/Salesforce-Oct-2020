<apex:page controller="AllAuditHistoryController" cache="true" expires="3600" showHeader="false" sidebar="false" standardStylesheets="false" contentType="text/csv#AllAuditHistory.csv;charset=UTF-8" readOnly="true">"CA Owner Name","Audit External Link","Audit Internal Link for Root Stores","Audit Internal Link for CAs","Document Type","Audit Statement Date","Period Start Date","Period End Date","Associated Certificate Name","Associated Certificate Type","Associated Certificate SHA256 Fingerprint","Associated Certificate Salesforce Record ID","Associated Certificate OneCRL Status","Root Cert Mozilla Status","Root Cert Mozilla Trust Bits","Root Cert Mozilla Approval Bug","Root Cert NSS Release When First Included","Root Cert Firefox Release When First Included","Root Cert NSS Release When Removed","Root Cert Firefox Release When Removed","Root Cert Mozilla Removal Bug No. Or Date"
<apex:repeat value="{!lstFAAssociation}" var="FAAss">
"{!FAAss.Certificate_Name__r.CA_Owner__c}","{!FAAss.File_Archive__r.External_Link__c}","{!FAAss.File_Archive__r.Internal_Link__c}","{!FAAss.File_Archive__r.Internal_Link_for_CAs__c}","{!FAAss.File_Archive__r.Document_Type__c}","<apex:outputText value="{0,date,MM/dd/yyyy}"><apex:param value="{!FAAss.File_Archive__r.Audit_Statement_Date__c}"/></apex:outputText>","<apex:outputText value="{0,date,MM/dd/yyyy}"><apex:param value="{!FAAss.File_Archive__r.Period_Start_Date__c}"/></apex:outputText>","<apex:outputText value="{0,date,MM/dd/yyyy}"><apex:param value="{!FAAss.File_Archive__r.Period_End_Date__c}"/></apex:outputText>","{!FAAss.Certificate_Name__r.Name}","{!FAAss.Certificate_Name__r.RecordType.Name}","{!FAAss.Certificate_Name__r.SHA_256_Fingerprint__c}","{!FAAss.Certificate_Name__c}","{!FAAss.Certificate_Name__r.OneCRL_Status__c}","{!If(FAAss.Certificate_Name__r.RecordType.Name == 'Root Certificate', FAAss.Certificate_Name__r.Status__c, '')}","{!If(FAAss.Certificate_Name__r.RecordType.Name == 'Root Certificate', FAAss.Certificate_Name__r.Trust_Bits__c,'')}","{!If(FAAss.Certificate_Name__r.RecordType.Name == 'Root Certificate', FAAss.Certificate_Name__r.Approval_Bug__c,'')}","{!If(FAAss.Certificate_Name__r.RecordType.Name == 'Root Certificate', FAAss.Certificate_Name__r.NSS_Release_When_First_Included__c,'')}","{!If(FAAss.Certificate_Name__r.RecordType.Name == 'Root Certificate',FAAss.Certificate_Name__r.Firefox_Release_When_First_Included__c,'')}","{!If(FAAss.Certificate_Name__r.RecordType.Name == 'Root Certificate',FAAss.Certificate_Name__r.NSS_Release_When_Removed__c,'')}","{!If(FAAss.Certificate_Name__r.RecordType.Name == 'Root Certificate',FAAss.Certificate_Name__r.Firefox_Release_When_Removed__c,'')}","{!If(FAAss.Certificate_Name__r.RecordType.Name == 'Root Certificate',FAAss.Certificate_Name__r.Removal_Bug_No_or_Date__c,'')}"
</apex:repeat>
</apex:page>