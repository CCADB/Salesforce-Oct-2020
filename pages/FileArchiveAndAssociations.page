<apex:page controller="FileArchiveAndAssociationsController" showHeader="false" sidebar="false" standardStylesheets="false" contentType="text/csv#FileArchiveAndAssociations.csv;charset=UTF-8" readOnly="true">"Archive ID","CA Owner","External Link","Internal Link","Document Type","Audit Statement Date","Period Start Date","Period End Date","Auditor","Auditor Location","Audit Deviation","Association ID","CA Owner/Certificate No","Certificate Name","Certificate Type","SHA-1 Fingerprint","Microsoft Root Status","Created Date","Last Modified Date"
<apex:repeat value="{!lstwrapAllFileArchiveAssoc}" var="wrap">
"{!wrap.fa.File_Archive__r.Name}","{!wrap.fa.File_Archive__r.CA_Owner__r.Name}","{!wrap.fa.File_Archive__r.External_Link__c}","{!wrap.fa.File_Archive__r.Internal_Link__c}","{!wrap.DocumentType}","<apex:outputText value="{0,date,MM/dd/yyyy}"><apex:param value="{!wrap.fa.File_Archive__r.Audit_Statement_Date__c}"/></apex:outputText>","<apex:outputText value="{0,date,MM/dd/yyyy}"><apex:param value="{!wrap.fa.File_Archive__r.Period_Start_Date__c}"/></apex:outputText>","<apex:outputText value="{0,date,MM/dd/yyyy}"><apex:param value="{!wrap.fa.File_Archive__r.Period_End_Date__c}"/></apex:outputText>","{!wrap.fa.File_Archive__r.Auditor__c}","{!wrap.fa.File_Archive__r.Auditor_Location__c}","{!wrap.fa.File_Archive__r.Audit_Deviation__c}","{!wrap.fa.Name}","{!wrap.fa.CA_Owner_Certificate_No__c}","{!wrap.fa.Certificate_Name__r.name}","{!wrap.fa.Certificate_Type__c}","{!wrap.fa.SHA_1_Fingerprint__c}","{!if(wrap.fa.Certificate_Name__r.RecordType.Name == 'Root Certificate',wrap.fa.Certificate_Name__r.Microsoft_Status__c, wrap.fa.Certificate_Name__r.Microsoft_Root_Status__c)}","<apex:outputText value="{0,date,MM/dd/yyyy}"><apex:param value="{!wrap.fa.CreatedDate}"/></apex:outputText>","<apex:outputText value="{0,date,MM/dd/yyyy}"><apex:param value="{!wrap.fa.LastModifiedDate}"/></apex:outputText>"
</apex:repeat>
</apex:page>